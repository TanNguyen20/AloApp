<div class="containerBody">

    <!-- Modal login -->
    <div class="modal fade" id="loginModal" tabindex="-1" aria-labelledby="loginModalLabel" aria-hidden="true">
        <form class="modal-dialog modal-dialog-centered" id="formLogin" method="POST" action="/login">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="login">Đăng nhập</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    {{>login}}
                </div>
                <div class="modal-footer">
                    <div class="wrapBtnRegister container">
                        <div class="faceGg row">
                            <a href="/auth/facebook" class="facebook btn mb-2">
                                <i class="fab fa-facebook"></i>&nbsp;Đăng nhập với Facebook
                            </a>
                            <a href="/auth/google" class="google btn mb-2">
                                <i class="fab fa-google"></i>&nbsp;Đăng nhập với Google
                            </a>
                        </div>
                        <div class=" d-sm-flex align-items-center justify-content-between row">
                            <button type="button" class="btn btn-secondary btnBack mb-2 col-sm"
                                data-bs-dismiss="modal">Trở về</button>
                            <button type="submit" id="btnLogin" class="btn btn-primary mb-2 col-sm">Đăng nhập</button>
                        </div>
                    </div>
                </div>
            </div>
        </form>
    </div>
    {{!-- Modal registers --}}
    <div class="modal fade" id="registersModal" tabindex="-1" aria-labelledby="registersModalLabel" aria-hidden="true">
        <form class="modal-dialog modal-dialog-centered" id="formRegister" method="POST" action="/register">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="registersModalLabel">Đăng kí tài khoản mới</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    {{>registers}}
                </div>
                <div class="modal-footer">
                    <div class="wrapBtnRegister container">
                        <div class="faceGg row">
                            <a href="/auth/facebook" class="facebook btn mb-2">
                                <i class="fab fa-facebook"></i>&nbsp;Đăng kí với Facebook
                            </a>
                            <a href="/auth/google" class="google btn mb-2">
                                <i class="fab fa-google"></i>&nbsp;Đăng kí với Google
                            </a>
                        </div>
                        <div class=" d-sm-flex align-items-center justify-content-between row">
                            <button type="button" class="btn btn-secondary btnBack mb-2 col-sm"
                                data-bs-dismiss="modal">Trở về</button>
                            <button id="btnRegister" type="submit" class="btn btn-primary mb-2 col-sm">Đăng kí</button>
                        </div>
                    </div>
                </div>
            </div>
        </form>
    </div>
    {{!--  --}}
    <!-- Modal forgot password -->
    <div class="modal fade" id="forgotPasswordModal" tabindex="-1" aria-labelledby="forgotPasswordModalLabel" aria-hidden="true">
        <form class="modal-dialog modal-dialog-centered" id="formForgotPassword" method="POST" action="/forgotPassword">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="login">Quên mật khẩu</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    {{>forgotPassword}}
                </div>
                <div class="modal-footer">
                    <div class="wrapBtnForgotPassword container">
                        <div class=" d-sm-flex align-items-center justify-content-between row">
                            <button type="button" class="btn btn-secondary btnBack mb-2 col-sm"
                                data-bs-dismiss="modal">Trở về</button>
                            <button type="submit" id="btnForgotPassword" class="btn btn-primary mb-2 col-sm">Gửi yêu cầu</button>
                        </div>
                    </div>
                </div>
            </div>
        </form>
    </div>
    {{!-- Modal change password --}}
    <div class="modal fade" id="changePasswordModal" tabindex="-1" aria-labelledby="changePasswordModalLabel" aria-hidden="true">
        <form class="modal-dialog modal-dialog-centered" id="formChangePassword" method="POST" action="/changePassword">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="changePassword">Thay đổi mật khẩu</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    {{>changePassword}}
                </div>
                <div class="modal-footer">
                    <div class="wrapBtnChangePassword container">
                        <div class=" d-sm-flex align-items-center justify-content-between row">
                            <button type="button" class="btn btn-secondary btnBack mb-2 col-sm"
                                data-bs-dismiss="modal">Trở về</button>
                            <button type="submit" id="btnChangePassword" class="btn btn-primary mb-2 col-sm">Đổi mật khẩu</button>
                        </div>
                    </div>
                </div>
            </div>
        </form>
    </div>
    <div class="container">
        <div class="container">
            <div class="row">
                <a class="col-sm border itemFunctions" href="/me/groupChat">
                    <i class="fas fa-users iconFunctions"></i></i><br>
                    Trò chuyện nhóm
                </a>
                <a class="col-sm border itemFunctions" href="/me/chat">
                    <i class="fas iconFunctions fa-user-friends"></i><br>
                    Trò chuyện
                </a>
                <a class="col-sm border itemFunctions" href="/me/friends">
                    <i class="far fa-address-book iconFunctions"></i></i><br>
                    Bạn bè
                </a>
            </div>
        </div>

        <div class="container">
            <div class="row">
                <a class="col-sm border itemFunctions" href="/findFriends">
                    <i class="fas fa-search iconFunctions"></i><br>
                    Tìm kiếm bạn bè
                </a>
                <a class="col-sm border itemFunctions" href="/me/profile">
                    <i class="fas fa-user-alt iconFunctions"></i><br>
                    Trang cá nhân
                </a>
                <a class="col-sm border itemFunctions" href="/about">
                    <i class="fas fa-info-circle iconFunctions"></i></i><br>
                    Thông tin sản phẩm
                </a>
            </div>
        </div>
    </div>

</div>
<script src="https://upload-widget.cloudinary.com/global/all.js" type="text/javascript"></script>  
<script src="/assets/js/validator.js"></script>
<script>
    var formLoginCheck = new Validator("#formLogin");
    var formForgotPasswordCheck = new Validator("#formForgotPassword");
    var formChangePasswordCheck = new Validator("#formChangePassword");
    $("#loginModal").on("hidden.bs.modal", function () {
        $(this)
            .find("input,textarea,select")
            .val('')
            .end()
            .find("input[type=checkbox], input[type=radio]")
            .prop("checked", "")
            .end();
        $('.form-message').text('');
    });
    $("#registersModal").on("hidden.bs.modal", function () {
        $(this)
            .find("input,textarea,select")
            .val('')
            .end()
            .find("input[type=checkbox], input[type=radio]")
            .prop("checked", "")
            .end();
        $('.form-message').text('');
    });
    //
    $(document).ready( function(){
        var formRegisterCheck = Validator("#formRegister");
        $('#btnRegister').click(function(ev){
            var formRegisterCheck1 = Validator("#formRegister");
            if(formRegisterCheck1) {
                ev.preventDefault();
                var displayName = $('#displayName').val();
                var usernameRegister = $('#usernameRegister').val();
                var passwordRegister = $('#passwordRegister').val();
                var email = $('#email').val();
                var numberPhone = $('#numberPhone').val();
                var formData ={displayName,username: usernameRegister,password: passwordRegister, numberPhone,email};
                $.post('/register',formData,async function(data, status){
                    if(data == 'thanhcong' && status == 'success'){
                        await swal({
                            title: "Thông báo",
                            text: "Bạn đã đăng kí thành công tài khoản\nKiểm tra email để hoàn thành việc đăng kí!",
                            icon: "success",
                            button: "Hoàn thành",
                        });
                        $.post('/verify/sendEmail',{email});
                        $("#registersModal").modal("hide");
                    }
                    else{
                        swal({
                            title: "Thông báo",
                            text: "Đăng kí thất bại!",
                            icon: "error",
                            button: "Trở lại",
                        });
                    }
                });
            }
        });
    });
    
</script>